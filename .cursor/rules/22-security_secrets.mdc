---
title: Security & Secrets
description: Secrets management, validation, least privilege, and privacy basics for Huddle
owner: security@huddle
severity: error
globs: "**/*"
last_review: 2025-11-25
next_review: 2026-01-01
---

## Huddle-specific secrets
- `SUPABASE_SERVICE_ROLE_KEY`: Server-side only (API routes), never in client.
- `CLERK_SECRET_KEY`: Server-side only (API route auth verification).
- `STRIPE_SECRET_KEY`: Server-side only (payment processing).
- `SUPABASE_ANON_KEY`: OK for client-side (respects RLS).

## Do
- Use secret managers/envs; no secrets in code or client.
- Validate all external inputs; sanitize outbound logs/messages.
- Enforce least-privilege tokens/keys; rotate as policy.

## Don't
- Commit `.env*` files; echo secrets in CI logs; log PII.

